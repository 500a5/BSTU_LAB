ORG 00H
  JMP START
ORG 0BH
  JMP INTCOUNTER ;TL0
ORG 1BH
  JMP INTTIMER ;TH0
ORG 8100H

INTCOUNTER:
  MOV TL0,#-125
  INC R6
  RETI

M1:
  JMP MINUTE_1
M2:
  JMP MINUTE_2
M3:
  JMP MINUTE_3
M4:
  JMP MINUTE_4
T_0:
  jmp Tick

INTTIMER:
  ;CLR TR1
  MOV TH0,#-80
  MOV A,R0
  DEC A
  JZ M1
  DEC A
  JZ M2
  DEC A
  JZ M3
  DEC A
  JZ M4

MINUTE_0:
  CJNE R5,#190,T_0
  CJNE R3,#0,PERIODPART_0
  CJNE R2,#0,PERIOD_0
  CJNE R1,#0,SECOND_0
  INC R0
  MOV R1,#59
  MOV R2,#9
  MOV R3,#5
  MOV P1,#01010000B
  CLR 02H
  MOV R5,#0
  JMP STARTTICK
SECOND_0:
  MOV A,R6
  MOV R7,A
  MOV R6,#0
  DEC R1
  MOV R2,#10
PERIOD_0:
  DEC R2
  MOV R3,#6
  CLR 02H
  mov p1,#10100000b
PERIODPART_0:
  DEC R3
  MOV R5,#0
  JB 02H,S
  CJNE R3,#2,NI_0
NI_0:
  jc INACTIVE_0
  ;MOV P1,#10100000B
  JMP STARTTICK
INACTIVE_0:
  MOV P1,#10010000B
  SETB 02H
  JMP STARTTICK
MINUTE_1:
  CJNE R5,#161,T
  CJNE R3,#0,PERIODPART_1
  CJNE R2,#0,PERIOD_1
  CJNE R1,#0,SECOND_1
  INC R0
  MOV R1,#59
  MOV R2,#9
  MOV R3,#5
  MOV P1,#10100000B
  CLR 02H
  MOV R5,#0
  JMP STARTTICK
SECOND_1:
  MOV A,R6
  MOV R7,A
  MOV R6,#0
  DEC R1
  MOV R2,#10
PERIOD_1:
  DEC R2
  MOV R3,#6
  CLR 02H
PERIODPART_1:
  DEC R3
  MOV R5,#0
  JB 02H,S
  CJNE R3,#1,NI_1
NI_1:
  JC INACTIVE_1
  MOV P1,#01010000B
  JMP STARTTICK
INACTIVE_1:
  MOV P1,#10010000B
  SETB 02H
  JMP STARTTICK
T:
  JMP TICK
S:
  JMP STARTTICK

MINUTE_2:
  CJNE R5,#160,T
  CJNE R3,#0,PERIODPART_2
  CJNE R2,#0,PERIOD_2
  CJNE R1,#0,SECOND_2
  INC R0
  MOV R1,#59
  MOV R2,#9
  MOV R3,#5
  MOV P1,#01010000B
  CLR 02H
  MOV R5,#0
  JMP STARTTICK
SECOND_2:
  MOV A,R6
  MOV R7,A
  MOV R6,#0
  DEC R1
  MOV R2,#10
PERIOD_2:
  DEC R2
  MOV R3,#6
  CLR 02H
PERIODPART_2:
  DEC R3
  MOV R5,#0
  JB 02H,S
  CJNE R3,#0,NI_2
NI_2:
  JC INACTIVE_2
  MOV P1,#10100000B
  JMP STARTTICK
INACTIVE_2:
  MOV P1,#10010000B
  SETB 02H
  JMP STARTTICK

MINUTE_3:
  CJNE R5,#190,TICK
  CJNE R3,#0,PERIODPART_3
  CJNE R2,#0,PERIOD_3
  CJNE R1,#0,SECOND_3
  INC R0
  MOV R1,#59
  MOV R2,#9
  MOV R3,#89
  MOV R4,#59
  MOV P1,#01010000B
  CLR 02H
  MOV R5,#0
  JMP STARTTICK
SECOND_3:
  MOV A,R6
  MOV R7,A
  MOV R6,#0
  DEC R1
  MOV R2,#10
PERIOD_3:
  DEC R2
  MOV R3,#6
  CLR 02H
PERIODPART_3:
  DEC R3
  MOV R5,#0
  JB 02H,STARTTICK
  CJNE R3,#0,NI_3
NI_3:
  JC INACTIVE_3
  MOV P1,#01010000B
  JMP STARTTICK
INACTIVE_3:
  MOV P1,#10010000B
  SETB 02H
  JMP STARTTICK
MINUTE_4:
  CJNE R5,#11,TICK
  CJNE R3,#0,PERIODPART_4
  CJNE R2,#0,PERIOD_4
  CJNE R1,#1,SECOND_4
  clr tr0
  clr tr1
  mov p1,#11111111b
  JMP END_
SECOND_4:
  MOV A,R6
  MOV R7,A
  MOV R6,#0
  DEC R1
  MOV R2,#10
PERIOD_4:
  DEC R2
  MOV R3,#90
  MOV A,R1
  MOV R4,A
  CLR 02H
PERIODPART_4:
  DEC R3
  MOV R5,#0
  JB 02H,STARTTICK
  DJNZ R4,NI_4
  JMP INACTIVE_4
NI_4:
  ;dec r4
  ;JC INACTIVE_4
  MOV P1,#01010000B
  JMP STARTTICK
INACTIVE_4:
  MOV P1,#10010000B
  SETB 02H
  ;JMP STARTTICK

STARTTICK:
  ;MOV TH0,#-101
  ;SETB TR1
  JMP END_
TICK:
  INC R5
  ;MOV TH0,#-101
  ;SETB TR1
END_:
  RETI

START:
  MOV P1,#0FFH
  CLR PSW.3
  CLR PSW.4
  CLR TR0
  CLR TR1
  MOV TH0,#-101
  MOV TL0,#-125
  MOV R0,#0 ;лхмсрю
  MOV R1,#59 ;яейсмдю
  MOV R2,#9 ;оепхнд онбрнпемхъ
  MOV R3,#5 ;вюярэ оепхндю онбрнпемхъ
  ;CLR 00H ;опълне | напюрмне бпюыемхе
  ;MOV R4,#10100000B ;мювюкэмне гмювемхе
  MOV R5,#0 ;16665==165*101
  MOV R6,#0 ;йнк-бн нанпнрнб дбхцюрекъ
  MOV R7,#0 ;йнк-бн нанпнрнб дбхцюрекъ б яейсмдс
  MOV 10H,#00010000B ;аюир дкъ оепбнцн якебю хмдхйюрнпю
  MOV 11H,#00100000B ;аюир дкъ брнпнцн якебю хмдхйюрнпю
  MOV 12H,#01000000B ;аюир дкъ рперэецн якебю хмдхйюрнпю
  MOV 13H,#10000000B ;аюир дкъ вербепрнцн якебю хмдхйюрнпю
  MOV P1,#10100000B
  MOV TMOD,#00110111B
  MOV IE,#10001010B
  MOV DPTR,#03H
  MOV A,#82H
  MOVX @DPTR,A
  CLR 02H
  SETB TR0
  SETB TR1
LABEL:
  MOV A,R7
  ;MOV B,6H
  ;MUL AB
  MOV B,#0AH
  DIV AB
  ORL B,#10000000B
  MOV 13H,B
  MOV B,#0AH
  DIV AB
  ORL B,#01000000B
  MOV 12H,B
 ; SETB ACC.4
 ; MOV 10H,A
  MOV DPTR,#02H ;юдпея онпрю я
  ;mov a,#01000000b
  ;movx @dptr,a
  ;jmp Label
OUTPUT:
  MOV 14H,#0fH
OUTPUT_0:
  MOV 15H,#0FH

OUTPUT_1:
  MOV A,13H
  MOVX @DPTR,A
  MOV 17H,#00H
PAUSE_0:
  DJNZ 17H,PAUSE_0 ;гюдепфйю
  MOV A,12H
  MOVX @DPTR,A
PAUSE_1:
  DJNZ 17H,PAUSE_1 ;гюдепфйю
  MOV A,11H
  MOVX @DPTR,A
PAUSE_2:
  DJNZ 17H,PAUSE_2
  MOV A,10H
  MOVX @DPTR,A
PAUSE_3:
  DJNZ 17H,PAUSE_3

  DJNZ 15H,OUTPUT_1
  DJNZ 14H,OUTPUT_0 ;бкнфеммше жхйкш

  JMP LABEL

  END
